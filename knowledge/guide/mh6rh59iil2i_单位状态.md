---
id: mh6rh59iil2i
title: 单位状态
url: https://act.mihoyo.com/ys/ugc/tutorial/detail/mh6rh59iil2i
sourceURL: https://act.mihoyo.com/ys/ugc/tutorial/detail/mh6rh59iil2i
description: undefined
language: zh
scope: guide
crawledAt: 2026-01-16T03:22:05.380Z
---

# 一、单位状态的定义

_单位状态_是一种面向关卡运行中，各单位实体额外功能与属性的状态管理模块。

实体单位在关卡运行中，可以被施加单位状态，每个状态必定存在一个明确的_施加者实体_。

每一个实体可以动态持有若干个状态，每个状态允许存在一定的运行时长，且在该时长内赋予该实体_额外效果_与_额外节点图_的功能，每种状态需要在编辑时预先定义，才能在运行时启用。

每个运行中的单位状态具有独立的_叠加层数_，一些状态中的功能可以与层数产生实时关联。

每个运行中的单位状态在超出_运行时长_，或失去所有的_叠加层数_时都会终止。

## 1.额外效果

所有_额外效果_均来自于预先提供的_效果池_，如“挂载循环特效”这类功能型的效果，或“运动速度变更量”这类数值型的效果。

每个额外效果在运行时对生效目标与生效强度都会有一定限制——

_生效目标_：每个效果只允许对“角色”、“造物”、“物件”中的一种或几种生效。当某个目标实体尝试持有一个单位状态时，若该状态中存在某个效果无法对该实体类型生效，则目标实体会无法成功持有该状态。以“挂载屏幕特效”为例，只允许对“角色”生效，故使用了此效果的状态只能对角色实体施加。

_生效强度_：实体可能同时获得多个同类型的额外效果，但其最终效果并不能无限叠加，而是被限制在一个有效范围内。以“运动速度变更量”为例，由于变更量不能小于-40%，也不能大于40%，故不论实体上具有一个速度变更量50%的效果，或是具有5个速度变更量10%的效果时，最终运动速度都不会超过140%。

此外，部分效果在同一个状态内无法同时存在，如一个状态下最多提供一种“元素附着”效果，若同时配置了多个_互斥_的效果，则会以最后一个效果为准。

## 2.额外节点图

每个单位状态允许关联一张服务器节点图，实体持有该状态时，此节点图会同步添加给对应实体，并且在失去该状态时，一并失去该节点图。

关联的节点图只能来自于_状态节点图_，状态节点图中依然可以使用复合节点。

与常规节点图不同的是，若实体持有的多个状态关联了相同的节点图，视为该节点图只关联了一次，且直到实体失去了所有相关状态时，该节点图才会失去关联。

# 二、单位状态的编辑

进入战斗预设页后，可以选择单位状态栏，依照自身习惯建立管理页签，并在页签内新建对应的单位状态。

点击【新建状态】，在弹出的窗口里点击确认创建即可新建一个单位状态

## 1.命名与标识

每个预定义的单位状态_命名_需要全局唯一，并且会自动生成全局唯一的_配置ID_。

可以利用复制按钮快速复制该配置ID。

允许替换每个状态的_图标_。

## 2.叠加规则

当一个状态叠加在已存在的状态上时，需要决定叠加时的细致规则。

每当叠加状态时，会将新状态的叠加计数一并计入已存在的状态中，但总数不会超过_叠加层数上限_。

不同情况下，叠加层数上限的最大值存在区别。

当可能超出叠加层数上限时，可以选择是否_更新过量叠加数据_。

若更新，则过量的叠加数据会依次顶替已经存在的首层叠加数据，反之会丢弃过量的叠加数据。

若该状态的叠加数据没有发生过变动，则视为本次叠加行为无效，且状态的施加行为也无效。

## 3.计时规则

每个运行中的单位状态可能存在一定的生命周期，若超出该周期，则会自然移除。

启用_无限持续时间_后，此状态就不会因超出生命周期而移除，对应的该状态的任何更新都不会再影响其持续时间。

若状态持续时间有限，当实体持有一个新的状态时，该状态的生命周期为_初始运行时长_。

持续时间有限的情况下，可以启用_叠加共享时长_。

禁用时，每个叠层都会有一个独立计算运行时长，在该叠层超出运行时长后，会自然移除，并减少相应的状态叠

加层数。

此情况下叠加层数上限最大为10。

启用时，所有叠层随着状态超出时长后统一移除，但每当叠加一层效果时，允许以一定规则延续状态的_剩余时长_。

每当叠加一层状态时，该状态此时的剩余时长可能会被增加_延续时长_。

启用_最大延续时长限制_后，延续后的剩余时长无法超过_最大时长_，即使原先的剩余时长超过该值。

此情况下叠加层数上限最大为1000。

## 4.关联节点图

实体持有状态时关联的_状态节点图_。

## 5.状态并存

对一个实体反复施加同一种单位状态时，可以根据施加者实体做出不同处理，并记录最近更新的时间。

同一个施加者无法对目标实体施加两份同名的单位状态，而是附加在已经施加的对应状态上。

不同施加者对目标实体施加同一种单位状态时，需要决定这些状态是否_不同施加来源可叠加_：

若可叠加，则叠加行为有效完成后，可以启用_记录最新施加者_。

若不可叠加，则需要注明不同施加来源的该状态的_并存上限_。

当新施加的状态已达到并存上限时，需要决定后续施加的_同名状态更新策略_：

_无法更新_——状态的施加失败，并终止该行为。

_最短剩余时长_——移除剩余时间最短的状态，并施加新的状态。

_最早更新时刻_——移除最近更新时间最早的状态，并施加新的状态，若状态未被重复施加过，则以

首次施加时刻计算。

_最早施加时刻_——移除施加时刻最早的状态，即使它的剩余时长并非最短的，并施加新的状态。

## 6.让位与顶替

施加状态时，_让位状态列表_可能影响施加行为的结果，_顶替状态列表_可能影响目标实体持有的状态。

如果目标已经持有了让位状态列表中的任意一种单位状态，则本次施加行为会直接终止并失败。

如果目标已经持有了顶替状态列表中的单位状态，则所有对应状态会被移除，随后施加该状态。

# 三、单位状态的运行

## 1.以组件施加

若为目标实体的_单位状态组件_配置了预设的单位状态，则在实体创建时，会被关卡实体施加对应的状态。

可以在组件中配置状态施加时的叠加计数，状态的施加顺序为配置的从上至下。

同一个状态在组件中只能被施加一次。

详情可见[单位状态](https://act.mihoyo.com/ys/ugc/tutorial//detail/mhd7nxrfa8im)

## 2.以服务器节点管理

施加者实体与施加目标实体都在场时，会尝试向目标施加对应的状态，并返回对应的结果：

_失败，其它异常_——其它如施加者或施加目标不存在于场上等特殊情况引起的失败

_失败，让位于其它状态_——目标已经持有让位状态列表中的一种或几种状态，未能正常施加

_失败，超出并存上限_——目标已持有并存数量上限的其它施加者造成的状态，且不接受顶替

_失败，附加叠层未成功_——附加在目标的状态上时，所有状态叠层已满，且不接受更新

_成功，施加新状态_——对目标施加了一个新的状态

_成功，槽位叠层_——对目标已经持有的状态进行了更新

**单位状态参数字典的使用**

部分单位状态可预先定义覆写标签，在【添加单位状态】节点实际使用中动态传入参数字典，如果字典中存在和覆写标签相同的键，则使该单位状态的配置值按照该键对应的值生效

注：动态版本的属性修改，无法和原版一起生效，只能设置其中的一个

举例：攻击力修正值初始配置值为10，且定义了覆写标签delta，节点图中使用参数字典修改了配置的值，则攻击力修正值在节点逻辑生效后变为20

当移除者实体在场时，会尝试移除目标对应的状态。

当移除目标持有一个或多个并存的状态时，可以选择：

_所有同名并存状态_——不论施加者是否为自己，目标持有的所有同名状态都将被移除

_最快丢失叠加层数的状态_——若状态叠层为独立计时，则首个叠层剩余时长最短的状态会被移除；若叠层不独立计时，则状态剩余时长最短的会被移除

（暂无）施加者为自己的状态——若目标的状态中存在施加者与自己一致的，则进行移除

当目标实体获得新的单位状态、或已持有的单位状态被更新时，会被推送此事件。

当目标实体失去已有的单位状态时，会被推送此事件。

若目标的多个并存状态都被移除，则会收到同等数量的事件。

被移除的原因包含：

_其它单位状态顶替_——由于新的状态被施加，导致该状态被顶替产生移除

_超出持续时间_——由于该状态超出持续时间，或所有状态叠层超出持续时间而自然终止

_被驱散_——由于该状态受技能、能力单元影响或元素被完全反应而强制终止

_状态失效_——由于该状态的部分效果终止而导致自身移除

_职业变更_——由于玩家切换了职业，导致原职业附带的状态移除

可以查询在场的目标实体是否已经持有了某个状态

## 3.以能力单元管理

可以在本地投射物的能力单元中添加或移除指定的单位状态

可以在本地投射物命中目标时，通过能力单元对其添加或移除单位状态

详情可见[能力单元](https://act.mihoyo.com/ys/ugc/tutorial//detail/mh0ucw9e76f6)

## 4.以技能节点图管理

施加者实体与施加目标实体都在场时，尝试向目标施加对应的状态，但无法得知最终的施加结果。

不论移除者实体是否在场，都会尝试移除目标对应的状态，若移除者实体不在场，则视为无来源移除行为。

不论状态的施加者是谁，所有配置ID相同的状态都会被移除。