const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Chat-9T5A1KkU.js","assets/markdown-vendor-CxDQP4uD.js","assets/react-vendor-KfUPlHYY.js","assets/Notes-ZQGJgbgQ.js","assets/ImageUploader-C0MLii57.js"])))=>i.map(i=>d[i]);
import{j as e}from"./markdown-vendor-CxDQP4uD.js";import{a as Q,r as c,R as q}from"./react-vendor-KfUPlHYY.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}})();var I={},$=Q;I.createRoot=$.createRoot,I.hydrateRoot=$.hydrateRoot;const H="modulepreload",J=function(t){return"/"+t},P={},O=function(r,s,o){let l=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),i=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));l=Promise.allSettled(s.map(u=>{if(u=J(u),u in P)return;P[u]=!0;const p=u.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const h=document.createElement("link");if(h.rel=p?"stylesheet":H,p||(h.as="script"),h.crossOrigin="",h.href=u,i&&h.setAttribute("nonce",i),document.head.appendChild(h),p)return new Promise((j,v)=>{h.addEventListener("load",j),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(n){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n}return l.then(n=>{for(const i of n||[])i.status==="rejected"&&a(i.reason);return r().catch(a)})},T="llm_config",A=()=>{const t=[400,80,500,500],r=t.reduce((l,a)=>l+a,0),s=Math.floor(Math.random()*r);let o=0;for(let l=0;l<t.length;l++)if(o+=t[l],s<o)return l+1;return 4},E={api_key:"",api_base_url:"https://api.deepseek.com/v1",model:"deepseek-chat",use_default_model:A(),context_length:1},V=()=>{const t=localStorage.getItem(T);if(t)try{return{...E,...JSON.parse(t)}}catch{return E}return E},D=t=>{localStorage.setItem(T,JSON.stringify(t))};function F({onClose:t,onConfigSaved:r}){const[s,o]=c.useState(V()),l=()=>{D(s),r==null||r(),t()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"OpenAI é…ç½®ï¼ˆä»…æµè§ˆå™¨å­˜å‚¨ï¼ŒåŽç«¯ä¸ä¿å­˜ï¼Œæ”¾å¿ƒå¡«å†™ï¼‰"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:s.use_default_model>0,onChange:a=>o({...s,use_default_model:a.target.checked?A():0}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"ä½¿ç”¨å…è´¹æ¨¡åž‹ï¼ˆé™é‡ï¼Œä¸”å¯èƒ½æ•ˆæžœä¸ä½³/å¯¹è¯ç”¨äºŽæä¾›å•†è®­ç»ƒï¼Œå»ºè®®è‡ªå¸¦LLMæœåŠ¡ï¼‰"})]}),s.use_default_model>0&&e.jsx("div",{className:"ml-6 space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"æ¸ é“ï¼ˆå„ä¸ªæ¸ é“æ— ä¼˜åŠ£ä¹‹åˆ†ï¼Œè‹¥æŸæ¸ é“æ— æ³•ä½¿ç”¨å¯å°è¯•å…¶ä»–æ¸ é“ï¼‰"}),e.jsxs("select",{value:s.use_default_model,onChange:a=>o({...s,use_default_model:parseInt(a.target.value)}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",children:[e.jsx("option",{value:1,children:"1.ç«å±±æ–¹èˆŸæ¸ é“"}),e.jsx("option",{value:2,children:"2.QQæœºå™¨äººä¸“ç”¨æ¸ é“"}),e.jsx("option",{value:3,children:"3.openrouterå…è´¹æ¨¡åž‹"}),e.jsx("option",{value:4,children:"4.å›½äº§æ–°æ¨¡åž‹ä½“éªŒæ¸ é“"}),e.jsx("option",{value:5,children:"5.ä¸´æ—¶æ¸ é“"})]})]})}),s.use_default_model===0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-2",children:["API Keyï¼ˆä½¿ç”¨Deepseekæ¨¡åž‹å¯",e.jsx("a",{href:"https://platform.deepseek.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"ç‚¹æ­¤å¹³å°èŽ·å–"}),"ï¼‰"]}),e.jsx("input",{type:"password",value:s.api_key,onChange:a=>o({...s,api_key:a.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",placeholder:"sk-xxxxxxxx"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"API Base URL"}),e.jsx("input",{type:"text",value:s.api_base_url,onChange:a=>o({...s,api_base_url:a.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Model"}),e.jsx("input",{type:"text",value:s.model,onChange:a=>o({...s,model:a.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"ä¸Šä¸‹æ–‡è½®æ•°ï¼ˆ0è¡¨ç¤ºä¸ä½¿ç”¨åŽ†å²å¯¹è¯ï¼‰"}),e.jsx("input",{type:"number",min:"0",max:"5",value:s.context_length,onChange:a=>{const n=parseInt(a.target.value);o({...s,context_length:isNaN(n)?A():n})},className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:l,className:"flex-1 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:"ä¿å­˜"})]})]})})}const N="chat_conversations";function k(){try{const t=localStorage.getItem(N);return t?JSON.parse(t):[]}catch{return[]}}function ne(t){return k().find(s=>s.id===t)||null}function le(t){const r=k(),s=r.findIndex(o=>o.id===t.id);s>=0?r[s]={...t,updatedAt:Date.now()}:r.push(t),localStorage.setItem(N,JSON.stringify(r))}function K(t,r){const s=k(),o=s.findIndex(l=>l.id===t);o>=0&&(s[o]={...s[o],title:r,updatedAt:Date.now()},localStorage.setItem(N,JSON.stringify(s)))}function G(t){const s=k().filter(o=>o.id!==t);localStorage.setItem(N,JSON.stringify(s))}function W(){localStorage.removeItem(N)}function ae(){const t=Date.now();return{id:`conv_${t}`,title:"æ–°å¯¹è¯",messages:[],createdAt:t,updatedAt:t}}function oe(t){const r=t.find(o=>o.role==="user");if(!r)return"æ–°å¯¹è¯";const s=r.content.trim();return s.length>20?s.substring(0,20)+"...":s}function ie(t){let r="";for(let a=0;a<t.messages.length;a++){const n=t.messages[a];"type"in n&&n.type==="sources"?(r+=`[Sources]
`,n.sources.forEach((i,u)=>{r+=`${u+1}. ${i.title} (${Math.round(i.similarity*100)}%)
`,r+=`   ${i.url}
`,i.text_snippet&&(r+=`   ${i.text_snippet.substring(0,100)}...
`)}),n.tokens&&(r+=`   Tokens: ${n.tokens}
`),r+=`
`):"role"in n&&(n.role==="user"?(r+=`Q. ${n.content}`,"imageBase64"in n&&n.imageBase64&&(r+=`
[ç”¨æˆ·å‘é€äº†å›¾ç‰‡]`),r+=`

`):n.role==="assistant"&&(r+=`A. ${n.content}

`))}r+=`=====
`;const s=new Blob([r],{type:"text/plain;charset=utf-8"}),o=URL.createObjectURL(s),l=document.createElement("a");l.href=o,l.download=`${t.title}_${new Date().toISOString().split("T")[0]}.txt`,l.click(),URL.revokeObjectURL(o)}function Y({activeTab:t,onTabChange:r,onConfigSaved:s,isOpen:o=!0,onToggle:l,currentConversationId:a,onConversationSelect:n,onConversationDeleted:i,conversationRefreshTrigger:u}){const[p,g]=c.useState(!1),[h,j]=c.useState([]),[v,C]=c.useState(!1),[_,y]=c.useState(null),[m,w]=c.useState(""),[b,M]=c.useState(!0);c.useEffect(()=>{t==="chat"&&(b||S(),localStorage.getItem("chat_clear_hint_seen")||(C(!0),localStorage.setItem("chat_clear_hint_seen","true")))},[t,u,b]);const S=()=>{j(k().sort((d,x)=>x.updatedAt-d.updatedAt))},B=(d,x)=>{x.stopPropagation(),confirm("ç¡®å®šåˆ é™¤æ­¤å¯¹è¯ï¼Ÿ")&&(G(d),S(),a===d&&(i==null||i()))},z=d=>{d.stopPropagation(),confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰åŽ†å²å¯¹è¯å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚")&&(W(),S(),i==null||i())},R=d=>{y(d.id),w(d.title)},L=d=>{m.trim()&&(K(d,m.trim()),S()),y(null)},U=[{id:"chat",label:"çŸ¥è¯†åº“é—®ç­”"},{id:"notes",label:"ç¬”è®°"},{id:"upload",label:"å›¾åºŠ"}];return e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-40 lg:hidden",onClick:l}),e.jsxs("aside",{className:`flex w-64 flex-col border-r border-emerald-100 bg-emerald-50/80 text-slate-900 shadow-sm transition-transform duration-300 lg:translate-x-0 ${o?"translate-x-0":"-translate-x-full"} fixed lg:relative h-full z-50 lg:z-auto`,children:[e.jsxs("div",{className:"border-b border-emerald-100 p-4 lg:p-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-lg lg:text-xl font-semibold",children:"åƒæ˜Ÿå·¥å…·ç®±"}),e.jsx("button",{onClick:l,className:"lg:hidden p-1 hover:bg-emerald-100 rounded-lg transition-colors","aria-label":"Close menu",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:U.map(d=>e.jsxs("div",{children:[e.jsx("button",{onClick:()=>r(d.id),className:`mb-3 w-full rounded-xl px-4 py-2.5 text-left text-sm font-medium transition-all ${t===d.id?"bg-emerald-200/70 text-emerald-900 shadow-sm border border-emerald-200 font-semibold":"text-slate-600 hover:bg-emerald-100/60 hover:text-slate-900"}`,children:d.label}),d.id==="chat"&&t==="chat"&&e.jsxs("div",{className:"mb-4 ml-2",children:[v&&e.jsxs("div",{className:"mb-3 p-3 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-700",children:["ðŸ’¡ æç¤ºï¼šè¯·åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„å¯¹è¯",e.jsx("button",{onClick:()=>C(!1),className:"float-right text-orange-400 hover:text-orange-600",children:"âœ•"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2 px-2 cursor-pointer hover:text-slate-700 select-none group/header",onClick:()=>M(!b),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"å¯¹è¯åŽ†å²"}),e.jsx("span",{className:`transform transition-transform duration-200 ${b?"-rotate-90":"rotate-0"}`,children:"â–¼"})]}),!b&&h.length>0&&e.jsx("button",{onClick:z,className:"opacity-0 group-hover/header:opacity-100 transition-opacity text-red-400 hover:text-red-600 px-1 rounded hover:bg-red-50",title:"æ¸…ç©ºæ‰€æœ‰åŽ†å²",children:"æ¸…ç©º"})]}),!b&&(h.length===0?e.jsx("div",{className:"text-xs text-slate-400 px-2 py-2",children:"æš‚æ— å¯¹è¯"}):e.jsx("div",{className:"space-y-1",children:h.map(x=>e.jsxs("div",{onClick:()=>n==null?void 0:n(x.id),className:`group flex items-center justify-between px-3 py-2 rounded-lg text-xs cursor-pointer transition-all ${a===x.id?"bg-emerald-100 text-emerald-900":"text-slate-600 hover:bg-emerald-100/50"}`,children:[_===x.id?e.jsx("input",{type:"text",value:m,onChange:f=>w(f.target.value),onBlur:()=>L(x.id),onKeyDown:f=>{f.key==="Enter"&&L(x.id),f.key==="Escape"&&y(null)},className:"flex-1 bg-white/50 border border-blue-300 rounded px-1 py-0.5 outline-none min-w-0",autoFocus:!0,onClick:f=>f.stopPropagation()}):e.jsx("span",{className:"truncate flex-1",onDoubleClick:f=>{f.stopPropagation(),R(x)},title:x.title,children:x.title}),e.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity shrink-0 ml-2",children:[!_&&e.jsx("button",{onClick:f=>{f.stopPropagation(),R(x)},className:"text-slate-400 hover:text-blue-600 mr-1",title:"é‡å‘½å",children:"âœï¸"}),e.jsx("button",{onClick:f=>B(x.id,f),className:"text-red-400 hover:text-red-600",title:"åˆ é™¤",children:"ðŸ—‘ï¸"})]})]},x.id))}))]})]},d.id))}),e.jsxs("div",{className:"border-t border-emerald-100 p-4 space-y-2",children:[e.jsxs("a",{href:"https://github.com/1475505/Miliastra-toolbox",target:"_blank",rel:"noopener noreferrer",className:"block w-full rounded-xl px-4 py-2.5 text-sm text-slate-600 transition-all hover:bg-emerald-100/50 hover:text-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),e.jsx("span",{children:"GitHub ä»“åº“"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1 ml-7",children:"æ¬¢è¿Ž Star â­"})]}),e.jsxs("a",{href:"https://qm.qq.com/q/M1mCoQN8ki",target:"_blank",rel:"noopener noreferrer",className:"block rounded-xl px-4 py-2.5 text-sm text-slate-600 transition-all hover:bg-emerald-100/50 hover:text-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673z"})}),e.jsx("span",{children:"ç”¨æˆ· QQ ç¾¤ï¼š1007538100"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1 ml-7",children:"å·²æŽ¥å…¥æœºå™¨äºº ðŸ¤–"})]}),e.jsx("div",{className:"rounded-2xl px-4 py-2.5 text-sm text-slate-600",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‘¤"}),e.jsx("span",{children:"ä½œè€… QQï¼š725230880"})]})})]}),e.jsx("div",{className:"border-t border-emerald-100 p-4",children:e.jsx("button",{onClick:()=>g(!0),className:"w-full rounded-xl px-4 py-2.5 text-sm font-medium bg-emerald-200/80 text-emerald-900 border border-emerald-300 hover:bg-emerald-300/80 focus:outline-none focus:ring-2 focus:ring-emerald-300 transition-all",title:"OpenAI é…ç½®","aria-label":"OpenAI é…ç½®",children:"âš™ï¸ OpenAI é…ç½®"})})]}),p&&e.jsx(F,{onClose:()=>g(!1),onConfigSaved:s})]})}const X=c.lazy(()=>O(()=>import("./Chat-9T5A1KkU.js"),__vite__mapDeps([0,1,2]))),Z=c.lazy(()=>O(()=>import("./Notes-ZQGJgbgQ.js"),__vite__mapDeps([3,1,2]))),ee=c.lazy(()=>O(()=>import("./ImageUploader-C0MLii57.js"),__vite__mapDeps([4,1,2])));function te(){const[t,r]=c.useState("chat"),[s,o]=c.useState(new Set(["chat"])),[l,a]=c.useState(0),[n,i]=c.useState(!1),[u,p]=c.useState(),[g,h]=c.useState(0),j=()=>{a(m=>m+1)},v=m=>{r(m),o(w=>new Set(w).add(m)),i(!1)},C=m=>{p(m),i(!1)},_=()=>{p(void 0)},y=()=>{h(m=>m+1)};return e.jsxs("div",{className:"flex h-screen bg-transparent",children:[e.jsx(Y,{activeTab:t,onTabChange:v,onConfigSaved:j,isOpen:n,onToggle:()=>i(!n),currentConversationId:u,onConversationSelect:C,onConversationDeleted:_,conversationRefreshTrigger:g}),e.jsxs("main",{className:"flex-1 overflow-hidden border-l border-white/20 bg-white/35 backdrop-blur-xl relative",children:[e.jsx("button",{onClick:()=>i(!n),className:"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white/80 backdrop-blur-sm rounded-lg shadow-lg text-slate-900","aria-label":"Toggle menu",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:`h-full ${t==="chat"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(X,{configVersion:l,currentConversationId:u,onConversationChange:p,onRefreshConversations:y})})}),s.has("notes")&&e.jsx("div",{className:`h-full ${t==="notes"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(Z,{})})}),s.has("upload")&&e.jsx("div",{className:`h-full ${t==="upload"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(ee,{})})})]})]})}I.createRoot(document.getElementById("root")).render(e.jsx(q.StrictMode,{children:e.jsx(te,{})}));export{oe as a,V as b,ae as c,ie as d,ne as g,le as s};
