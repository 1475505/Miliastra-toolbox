const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Chat.js","assets/markdown-vendor.js","assets/react-vendor.js","assets/Notes.js","assets/ImageUploader.js"])))=>i.map(i=>d[i]);
import{j as e}from"./markdown-vendor.js";import{a as D,r as c,R as U}from"./react-vendor.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();var I={},L=D;I.createRoot=L.createRoot,I.hydrateRoot=L.hydrateRoot;const B="modulepreload",q=function(t){return"/"+t},$={},O=function(r,s,a){let o=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),i=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));o=Promise.allSettled(s.map(u=>{if(u=q(u),u in $)return;$[u]=!0;const p=u.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const h=document.createElement("link");if(h.rel=p?"stylesheet":B,p||(h.as="script"),h.crossOrigin="",h.href=u,i&&h.setAttribute("nonce",i),document.head.appendChild(h),p)return new Promise((b,j)=>{h.addEventListener("load",b),h.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(n){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n}return o.then(n=>{for(const i of n||[])i.status==="rejected"&&l(i.reason);return r().catch(l)})},P="llm_config",E={api_key:"",api_base_url:"https://api.deepseek.com/v1",model:"deepseek-chat",use_default_model:0,context_length:1},H=()=>{const t=localStorage.getItem(P);if(t)try{return{...E,...JSON.parse(t)}}catch{return E}return E},J=t=>{localStorage.setItem(P,JSON.stringify(t))};function Q({onClose:t,onConfigSaved:r}){const[s,a]=c.useState(H()),o=()=>{J(s),r==null||r(),t()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"OpenAI é…ç½®ï¼ˆä»…æµè§ˆå™¨å­˜å‚¨ï¼ŒåŽç«¯ä¸ä¿å­˜ï¼Œæ”¾å¿ƒå¡«å†™ï¼‰"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:s.use_default_model>0,onChange:l=>a({...s,use_default_model:l.target.checked?1:0}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"ä½¿ç”¨å…è´¹æ¨¡åž‹ï¼ˆé™é‡ï¼Œä¸”å¯èƒ½æ•ˆæžœä¸ä½³ï¼Œå»ºè®®è‡ªå¸¦LLMæœåŠ¡ï¼‰"})]}),s.use_default_model>0&&e.jsxs("label",{className:"flex items-center ml-6",children:[e.jsx("input",{type:"checkbox",checked:s.use_default_model===2,onChange:l=>a({...s,use_default_model:l.target.checked?2:1}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"é™çº§æ¨¡åž‹ï¼ˆè‹¥å½“å‰å…è´¹æ¨¡åž‹æ— æ³•ä½¿ç”¨ï¼Œè¯·å‹¾é€‰ï¼Œè‹¥è¿˜æ˜¯æ— æ³•ä½¿ç”¨ï¼Œè¯·è°ƒä½Žè½®æ¬¡ï¼Œæˆ–è‡ªå®šä¹‰æ¨¡åž‹ï¼‰"})]}),s.use_default_model===0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-2",children:["API Keyï¼ˆä½¿ç”¨Deepseekæ¨¡åž‹å¯",e.jsx("a",{href:"https://platform.deepseek.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"ç‚¹æ­¤å¹³å°èŽ·å–"}),"ï¼‰"]}),e.jsx("input",{type:"password",value:s.api_key,onChange:l=>a({...s,api_key:l.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",placeholder:"sk-xxxxxxxx"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"API Base URL"}),e.jsx("input",{type:"text",value:s.api_base_url,onChange:l=>a({...s,api_base_url:l.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Model"}),e.jsx("input",{type:"text",value:s.model,onChange:l=>a({...s,model:l.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"ä¸Šä¸‹æ–‡è½®æ•°ï¼ˆ0è¡¨ç¤ºä¸ä½¿ç”¨åŽ†å²å¯¹è¯ï¼‰"}),e.jsx("input",{type:"number",min:"0",max:"20",value:s.context_length,onChange:l=>{const n=parseInt(l.target.value);a({...s,context_length:isNaN(n)?3:n})},className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:o,className:"flex-1 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:"ä¿å­˜"})]})]})})}const k="chat_conversations";function y(){try{const t=localStorage.getItem(k);return t?JSON.parse(t):[]}catch{return[]}}function te(t){return y().find(s=>s.id===t)||null}function se(t){const r=y(),s=r.findIndex(a=>a.id===t.id);s>=0?r[s]={...t,updatedAt:Date.now()}:r.push(t),localStorage.setItem(k,JSON.stringify(r))}function V(t,r){const s=y(),a=s.findIndex(o=>o.id===t);a>=0&&(s[a]={...s[a],title:r,updatedAt:Date.now()},localStorage.setItem(k,JSON.stringify(s)))}function F(t){const s=y().filter(a=>a.id!==t);localStorage.setItem(k,JSON.stringify(s))}function ne(){const t=Date.now();return{id:`conv_${t}`,title:"æ–°å¯¹è¯",messages:[],createdAt:t,updatedAt:t}}function re(t){const r=t.find(a=>a.role==="user");if(!r)return"æ–°å¯¹è¯";const s=r.content.trim();return s.length>20?s.substring(0,20)+"...":s}function le(t){let r="";for(let l=0;l<t.messages.length;l++){const n=t.messages[l];"type"in n&&n.type==="sources"?(r+=`[Sources]
`,n.sources.forEach((i,u)=>{r+=`${u+1}. ${i.title} (${Math.round(i.similarity*100)}%)
`,r+=`   ${i.url}
`,i.text_snippet&&(r+=`   ${i.text_snippet.substring(0,100)}...
`)}),n.tokens&&(r+=`   Tokens: ${n.tokens}
`),r+=`
`):"role"in n&&(n.role==="user"?r+=`Q. ${n.content}

`:n.role==="assistant"&&(r+=`A. ${n.content}

`))}r+=`=====
`;const s=new Blob([r],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download=`${t.title}_${new Date().toISOString().split("T")[0]}.txt`,o.click(),URL.revokeObjectURL(a)}function K({activeTab:t,onTabChange:r,onConfigSaved:s,isOpen:a=!0,onToggle:o,currentConversationId:l,onConversationSelect:n,onConversationDeleted:i,conversationRefreshTrigger:u}){const[p,g]=c.useState(!1),[h,b]=c.useState([]),[j,N]=c.useState(!1),[w,v]=c.useState(null),[m,_]=c.useState(""),[C,T]=c.useState(!1);c.useEffect(()=>{t==="chat"&&(S(),localStorage.getItem("chat_clear_hint_seen")||(N(!0),localStorage.setItem("chat_clear_hint_seen","true")))},[t,u]);const S=()=>{b(y().sort((d,x)=>x.updatedAt-d.updatedAt))},M=(d,x)=>{x.stopPropagation(),confirm("ç¡®å®šåˆ é™¤æ­¤å¯¹è¯ï¼Ÿ")&&(F(d),S(),l===d&&(i==null||i()))},A=d=>{v(d.id),_(d.title)},R=d=>{m.trim()&&(V(d,m.trim()),S()),v(null)},z=[{id:"chat",label:"çŸ¥è¯†åº“é—®ç­”"},{id:"notes",label:"ç¬”è®°"},{id:"upload",label:"å›¾åºŠ"}];return e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-40 lg:hidden",onClick:o}),e.jsxs("aside",{className:`flex w-64 flex-col border-r border-white/30 bg-white/30 text-slate-900 backdrop-blur-2xl shadow-[0_20px_60px_rgba(15,23,42,0.12)] transition-transform duration-300 lg:translate-x-0 ${a?"translate-x-0":"-translate-x-full"} fixed lg:relative h-full z-50 lg:z-auto`,children:[e.jsxs("div",{className:"border-b border-white/30 p-4 lg:p-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-lg lg:text-xl font-semibold",children:"åƒæ˜Ÿå·¥å…·ç®±"}),e.jsx("button",{onClick:o,className:"lg:hidden p-1 hover:bg-white/30 rounded-lg transition-colors","aria-label":"Close menu",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:z.map(d=>e.jsxs("div",{children:[e.jsx("button",{onClick:()=>r(d.id),className:`mb-3 w-full rounded-2xl px-4 py-3 text-left text-sm font-medium transition-all ${t===d.id?"bg-yellow-200/90 text-slate-900 shadow-lg shadow-yellow-300/30 border border-yellow-300 font-semibold":"text-slate-600 hover:bg-white/30 hover:text-slate-900"}`,children:d.label}),d.id==="chat"&&t==="chat"&&e.jsxs("div",{className:"mb-4 ml-2",children:[j&&e.jsxs("div",{className:"mb-3 p-3 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-700",children:["ðŸ’¡ æç¤ºï¼šè¯·åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„å¯¹è¯",e.jsx("button",{onClick:()=>N(!1),className:"float-right text-orange-400 hover:text-orange-600",children:"âœ•"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2 px-2 cursor-pointer hover:text-slate-700 select-none",onClick:()=>T(!C),children:[e.jsx("span",{children:"å¯¹è¯åŽ†å²"}),e.jsx("span",{className:`transform transition-transform duration-200 ${C?"-rotate-90":"rotate-0"}`,children:"â–¼"})]}),!C&&(h.length===0?e.jsx("div",{className:"text-xs text-slate-400 px-2 py-2",children:"æš‚æ— å¯¹è¯"}):e.jsx("div",{className:"space-y-1",children:h.map(x=>e.jsxs("div",{onClick:()=>n==null?void 0:n(x.id),className:`group flex items-center justify-between px-3 py-2 rounded-xl text-xs cursor-pointer transition-all ${l===x.id?"bg-blue-100 text-blue-900":"text-slate-600 hover:bg-white/30"}`,children:[w===x.id?e.jsx("input",{type:"text",value:m,onChange:f=>_(f.target.value),onBlur:()=>R(x.id),onKeyDown:f=>{f.key==="Enter"&&R(x.id),f.key==="Escape"&&v(null)},className:"flex-1 bg-white/50 border border-blue-300 rounded px-1 py-0.5 outline-none min-w-0",autoFocus:!0,onClick:f=>f.stopPropagation()}):e.jsx("span",{className:"truncate flex-1",onDoubleClick:f=>{f.stopPropagation(),A(x)},title:x.title,children:x.title}),e.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity shrink-0 ml-2",children:[!w&&e.jsx("button",{onClick:f=>{f.stopPropagation(),A(x)},className:"text-slate-400 hover:text-blue-600 mr-1",title:"é‡å‘½å",children:"âœï¸"}),e.jsx("button",{onClick:f=>M(x.id,f),className:"text-red-400 hover:text-red-600",title:"åˆ é™¤",children:"ðŸ—‘ï¸"})]})]},x.id))}))]})]},d.id))}),e.jsxs("div",{className:"border-t border-white/20 p-4 space-y-2",children:[e.jsxs("a",{href:"https://github.com/1475505/Miliastra-toolbox",target:"_blank",rel:"noopener noreferrer",className:"block w-full rounded-2xl px-4 py-2.5 text-sm text-slate-600 transition-all hover:bg-white/30 hover:text-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),e.jsx("span",{children:"GitHub ä»“åº“"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1 ml-7",children:"æ¬¢è¿Ž Star â­"})]}),e.jsxs("a",{href:"https://qm.qq.com/q/M1mCoQN8ki",target:"_blank",rel:"noopener noreferrer",className:"block rounded-2xl px-4 py-2.5 text-sm text-slate-600 transition-all hover:bg-white/30 hover:text-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673z"})}),e.jsx("span",{children:"ç”¨æˆ· QQ ç¾¤ï¼š1007538100"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1 ml-7",children:"å·²æŽ¥å…¥æœºå™¨äºº ðŸ¤–"})]}),e.jsx("div",{className:"rounded-2xl px-4 py-2.5 text-sm text-slate-600",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‘¤"}),e.jsx("span",{children:"ä½œè€… QQï¼š725230880"})]})})]}),e.jsx("div",{className:"border-t border-white/20 p-4",children:e.jsx("button",{onClick:()=>g(!0),className:"w-full rounded-2xl px-4 py-3 text-sm font-medium bg-green-200 text-slate-900 border border-yellow-300 hover:bg-yellow-300 focus:outline-none focus:ring-2 focus:ring-yellow-300 transition-all",title:"OpenAI é…ç½®","aria-label":"OpenAI é…ç½®",children:"âš™ï¸ OpenAI é…ç½®"})})]}),p&&e.jsx(Q,{onClose:()=>g(!1),onConfigSaved:s})]})}const G=c.lazy(()=>O(()=>import("./Chat.js"),__vite__mapDeps([0,1,2]))),W=c.lazy(()=>O(()=>import("./Notes.js"),__vite__mapDeps([3,1,2]))),Y=c.lazy(()=>O(()=>import("./ImageUploader.js"),__vite__mapDeps([4,1,2])));function X(){const[t,r]=c.useState("chat"),[s,a]=c.useState(new Set(["chat"])),[o,l]=c.useState(0),[n,i]=c.useState(!1),[u,p]=c.useState(),[g,h]=c.useState(0),b=()=>{l(m=>m+1)},j=m=>{r(m),a(_=>new Set(_).add(m)),i(!1)},N=m=>{p(m),i(!1)},w=()=>{p(void 0)},v=()=>{h(m=>m+1)};return e.jsxs("div",{className:"flex h-screen bg-transparent",children:[e.jsx(K,{activeTab:t,onTabChange:j,onConfigSaved:b,isOpen:n,onToggle:()=>i(!n),currentConversationId:u,onConversationSelect:N,onConversationDeleted:w,conversationRefreshTrigger:g}),e.jsxs("main",{className:"flex-1 overflow-hidden border-l border-white/20 bg-white/35 backdrop-blur-xl relative",children:[e.jsx("button",{onClick:()=>i(!n),className:"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white/80 backdrop-blur-sm rounded-lg shadow-lg text-slate-900","aria-label":"Toggle menu",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:`h-full ${t==="chat"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(G,{configVersion:o,currentConversationId:u,onConversationChange:p,onRefreshConversations:v})})}),s.has("notes")&&e.jsx("div",{className:`h-full ${t==="notes"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(W,{})})}),s.has("upload")&&e.jsx("div",{className:`h-full ${t==="upload"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(Y,{})})})]})]})}I.createRoot(document.getElementById("root")).render(e.jsx(U.StrictMode,{children:e.jsx(X,{})}));export{re as a,H as b,ne as c,le as d,te as g,se as s};
