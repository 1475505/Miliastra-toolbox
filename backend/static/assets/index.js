const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Chat.js","assets/markdown-vendor.js","assets/react-vendor.js","assets/Notes.js","assets/ImageUploader.js"])))=>i.map(i=>d[i]);
import{j as e}from"./markdown-vendor.js";import{a as D,r as c,R as U}from"./react-vendor.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(r){if(r.ep)return;r.ep=!0;const l=s(r);fetch(r.href,l)}})();var I={},L=D;I.createRoot=L.createRoot,I.hydrateRoot=L.hydrateRoot;const B="modulepreload",q=function(t){return"/"+t},$={},O=function(n,s,a){let r=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(s.map(u=>{if(u=q(u),u in $)return;$[u]=!0;const p=u.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const h=document.createElement("link");if(h.rel=p?"stylesheet":B,p||(h.as="script"),h.crossOrigin="",h.href=u,i&&h.setAttribute("nonce",i),document.head.appendChild(h),p)return new Promise((b,v)=>{h.addEventListener("load",b),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return r.then(o=>{for(const i of o||[])i.status==="rejected"&&l(i.reason);return n().catch(l)})},P="llm_config",H=()=>{const t=[200,80,500,500],n=t.reduce((r,l)=>r+l,0),s=Math.floor(Math.random()*n);let a=0;for(let r=0;r<t.length;r++)if(a+=t[r],s<a)return r+1;return 4},E={api_key:"",api_base_url:"https://api.deepseek.com/v1",model:"deepseek-chat",use_default_model:H(),context_length:1},J=()=>{const t=localStorage.getItem(P);if(t)try{return{...E,...JSON.parse(t)}}catch{return E}return E},Q=t=>{localStorage.setItem(P,JSON.stringify(t))};function V({onClose:t,onConfigSaved:n}){const[s,a]=c.useState(J()),r=()=>{Q(s),n==null||n(),t()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6",children:"OpenAI é…ç½®ï¼ˆä»…æµè§ˆå™¨å­˜å‚¨ï¼ŒåŽç«¯ä¸ä¿å­˜ï¼Œæ”¾å¿ƒå¡«å†™ï¼‰"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:s.use_default_model>0,onChange:l=>a({...s,use_default_model:l.target.checked?3:0}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"ä½¿ç”¨å…è´¹æ¨¡åž‹ï¼ˆé™é‡ï¼Œä¸”å¯èƒ½æ•ˆæžœä¸ä½³ï¼Œå»ºè®®è‡ªå¸¦LLMæœåŠ¡ï¼‰"})]}),s.use_default_model>0&&e.jsx("div",{className:"ml-6 space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"æ¸ é“ï¼ˆå„ä¸ªæ¸ é“æ— ä¼˜åŠ£ä¹‹åˆ†ï¼Œè‹¥æŸæ¸ é“æ— æ³•ä½¿ç”¨å¯å°è¯•å…¶ä»–æ¸ é“ï¼‰"}),e.jsxs("select",{value:s.use_default_model,onChange:l=>a({...s,use_default_model:parseInt(l.target.value)}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",children:[e.jsx("option",{value:1,children:"æ¸ é“ 1"}),e.jsx("option",{value:2,children:"æ¸ é“ 2"}),e.jsx("option",{value:3,children:"æ¸ é“ 3"}),e.jsx("option",{value:4,children:"æ¸ é“ 4"})]})]})}),s.use_default_model===0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-2",children:["API Keyï¼ˆä½¿ç”¨Deepseekæ¨¡åž‹å¯",e.jsx("a",{href:"https://platform.deepseek.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"ç‚¹æ­¤å¹³å°èŽ·å–"}),"ï¼‰"]}),e.jsx("input",{type:"password",value:s.api_key,onChange:l=>a({...s,api_key:l.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900",placeholder:"sk-xxxxxxxx"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"API Base URL"}),e.jsx("input",{type:"text",value:s.api_base_url,onChange:l=>a({...s,api_base_url:l.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Model"}),e.jsx("input",{type:"text",value:s.model,onChange:l=>a({...s,model:l.target.value}),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"ä¸Šä¸‹æ–‡è½®æ•°ï¼ˆ0è¡¨ç¤ºä¸ä½¿ç”¨åŽ†å²å¯¹è¯ï¼‰"}),e.jsx("input",{type:"number",min:"0",max:"20",value:s.context_length,onChange:l=>{const o=parseInt(l.target.value);a({...s,context_length:isNaN(o)?3:o})},className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:r,className:"flex-1 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:"ä¿å­˜"})]})]})})}const C="chat_conversations";function y(){try{const t=localStorage.getItem(C);return t?JSON.parse(t):[]}catch{return[]}}function se(t){return y().find(s=>s.id===t)||null}function ne(t){const n=y(),s=n.findIndex(a=>a.id===t.id);s>=0?n[s]={...t,updatedAt:Date.now()}:n.push(t),localStorage.setItem(C,JSON.stringify(n))}function F(t,n){const s=y(),a=s.findIndex(r=>r.id===t);a>=0&&(s[a]={...s[a],title:n,updatedAt:Date.now()},localStorage.setItem(C,JSON.stringify(s)))}function K(t){const s=y().filter(a=>a.id!==t);localStorage.setItem(C,JSON.stringify(s))}function re(){const t=Date.now();return{id:`conv_${t}`,title:"æ–°å¯¹è¯",messages:[],createdAt:t,updatedAt:t}}function le(t){const n=t.find(a=>a.role==="user");if(!n)return"æ–°å¯¹è¯";const s=n.content.trim();return s.length>20?s.substring(0,20)+"...":s}function oe(t){let n="";for(let l=0;l<t.messages.length;l++){const o=t.messages[l];"type"in o&&o.type==="sources"?(n+=`[Sources]
`,o.sources.forEach((i,u)=>{n+=`${u+1}. ${i.title} (${Math.round(i.similarity*100)}%)
`,n+=`   ${i.url}
`,i.text_snippet&&(n+=`   ${i.text_snippet.substring(0,100)}...
`)}),o.tokens&&(n+=`   Tokens: ${o.tokens}
`),n+=`
`):"role"in o&&(o.role==="user"?n+=`Q. ${o.content}

`:o.role==="assistant"&&(n+=`A. ${o.content}

`))}n+=`=====
`;const s=new Blob([n],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=`${t.title}_${new Date().toISOString().split("T")[0]}.txt`,r.click(),URL.revokeObjectURL(a)}function G({activeTab:t,onTabChange:n,onConfigSaved:s,isOpen:a=!0,onToggle:r,currentConversationId:l,onConversationSelect:o,onConversationDeleted:i,conversationRefreshTrigger:u}){const[p,g]=c.useState(!1),[h,b]=c.useState([]),[v,N]=c.useState(!1),[w,j]=c.useState(null),[f,_]=c.useState(""),[k,T]=c.useState(!1);c.useEffect(()=>{t==="chat"&&(S(),localStorage.getItem("chat_clear_hint_seen")||(N(!0),localStorage.setItem("chat_clear_hint_seen","true")))},[t,u]);const S=()=>{b(y().sort((d,x)=>x.updatedAt-d.updatedAt))},M=(d,x)=>{x.stopPropagation(),confirm("ç¡®å®šåˆ é™¤æ­¤å¯¹è¯ï¼Ÿ")&&(K(d),S(),l===d&&(i==null||i()))},R=d=>{j(d.id),_(d.title)},A=d=>{f.trim()&&(F(d,f.trim()),S()),j(null)},z=[{id:"chat",label:"çŸ¥è¯†åº“é—®ç­”"},{id:"notes",label:"ç¬”è®°"},{id:"upload",label:"å›¾åºŠ"}];return e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-40 lg:hidden",onClick:r}),e.jsxs("aside",{className:`flex w-64 flex-col border-r border-white/30 bg-white/30 text-slate-900 backdrop-blur-2xl shadow-[0_20px_60px_rgba(15,23,42,0.12)] transition-transform duration-300 lg:translate-x-0 ${a?"translate-x-0":"-translate-x-full"} fixed lg:relative h-full z-50 lg:z-auto`,children:[e.jsxs("div",{className:"border-b border-white/30 p-4 lg:p-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-lg lg:text-xl font-semibold",children:"åƒæ˜Ÿå·¥å…·ç®±"}),e.jsx("button",{onClick:r,className:"lg:hidden p-1 hover:bg-white/30 rounded-lg transition-colors","aria-label":"Close menu",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("nav",{className:"flex-1 p-4 overflow-y-auto",children:z.map(d=>e.jsxs("div",{children:[e.jsx("button",{onClick:()=>n(d.id),className:`mb-3 w-full rounded-2xl px-4 py-3 text-left text-sm font-medium transition-all ${t===d.id?"bg-yellow-200/90 text-slate-900 shadow-lg shadow-yellow-300/30 border border-yellow-300 font-semibold":"text-slate-600 hover:bg-white/30 hover:text-slate-900"}`,children:d.label}),d.id==="chat"&&t==="chat"&&e.jsxs("div",{className:"mb-4 ml-2",children:[v&&e.jsxs("div",{className:"mb-3 p-3 bg-orange-50 border border-orange-200 rounded-xl text-xs text-orange-700",children:["ðŸ’¡ æç¤ºï¼šè¯·åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„å¯¹è¯",e.jsx("button",{onClick:()=>N(!1),className:"float-right text-orange-400 hover:text-orange-600",children:"âœ•"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2 px-2 cursor-pointer hover:text-slate-700 select-none",onClick:()=>T(!k),children:[e.jsx("span",{children:"å¯¹è¯åŽ†å²"}),e.jsx("span",{className:`transform transition-transform duration-200 ${k?"-rotate-90":"rotate-0"}`,children:"â–¼"})]}),!k&&(h.length===0?e.jsx("div",{className:"text-xs text-slate-400 px-2 py-2",children:"æš‚æ— å¯¹è¯"}):e.jsx("div",{className:"space-y-1",children:h.map(x=>e.jsxs("div",{onClick:()=>o==null?void 0:o(x.id),className:`group flex items-center justify-between px-3 py-2 rounded-xl text-xs cursor-pointer transition-all ${l===x.id?"bg-blue-100 text-blue-900":"text-slate-600 hover:bg-white/30"}`,children:[w===x.id?e.jsx("input",{type:"text",value:f,onChange:m=>_(m.target.value),onBlur:()=>A(x.id),onKeyDown:m=>{m.key==="Enter"&&A(x.id),m.key==="Escape"&&j(null)},className:"flex-1 bg-white/50 border border-blue-300 rounded px-1 py-0.5 outline-none min-w-0",autoFocus:!0,onClick:m=>m.stopPropagation()}):e.jsx("span",{className:"truncate flex-1",onDoubleClick:m=>{m.stopPropagation(),R(x)},title:x.title,children:x.title}),e.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity shrink-0 ml-2",children:[!w&&e.jsx("button",{onClick:m=>{m.stopPropagation(),R(x)},className:"text-slate-400 hover:text-blue-600 mr-1",title:"é‡å‘½å",children:"âœï¸"}),e.jsx("button",{onClick:m=>M(x.id,m),className:"text-red-400 hover:text-red-600",title:"åˆ é™¤",children:"ðŸ—‘ï¸"})]})]},x.id))}))]})]},d.id))}),e.jsxs("div",{className:"border-t border-white/20 p-4 space-y-2",children:[e.jsxs("a",{href:"https://github.com/1475505/Miliastra-toolbox",target:"_blank",rel:"noopener noreferrer",className:"block w-full rounded-2xl px-4 py-2.5 text-sm text-slate-600 transition-all hover:bg-white/30 hover:text-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})}),e.jsx("span",{children:"GitHub ä»“åº“"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1 ml-7",children:"æ¬¢è¿Ž Star â­"})]}),e.jsxs("a",{href:"https://qm.qq.com/q/M1mCoQN8ki",target:"_blank",rel:"noopener noreferrer",className:"block rounded-2xl px-4 py-2.5 text-sm text-slate-600 transition-all hover:bg-white/30 hover:text-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673z"})}),e.jsx("span",{children:"ç”¨æˆ· QQ ç¾¤ï¼š1007538100"})]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1 ml-7",children:"å·²æŽ¥å…¥æœºå™¨äºº ðŸ¤–"})]}),e.jsx("div",{className:"rounded-2xl px-4 py-2.5 text-sm text-slate-600",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ‘¤"}),e.jsx("span",{children:"ä½œè€… QQï¼š725230880"})]})})]}),e.jsx("div",{className:"border-t border-white/20 p-4",children:e.jsx("button",{onClick:()=>g(!0),className:"w-full rounded-2xl px-4 py-3 text-sm font-medium bg-green-200 text-slate-900 border border-yellow-300 hover:bg-yellow-300 focus:outline-none focus:ring-2 focus:ring-yellow-300 transition-all",title:"OpenAI é…ç½®","aria-label":"OpenAI é…ç½®",children:"âš™ï¸ OpenAI é…ç½®"})})]}),p&&e.jsx(V,{onClose:()=>g(!1),onConfigSaved:s})]})}const W=c.lazy(()=>O(()=>import("./Chat.js"),__vite__mapDeps([0,1,2]))),Y=c.lazy(()=>O(()=>import("./Notes.js"),__vite__mapDeps([3,1,2]))),X=c.lazy(()=>O(()=>import("./ImageUploader.js"),__vite__mapDeps([4,1,2])));function Z(){const[t,n]=c.useState("chat"),[s,a]=c.useState(new Set(["chat"])),[r,l]=c.useState(0),[o,i]=c.useState(!1),[u,p]=c.useState(),[g,h]=c.useState(0),b=()=>{l(f=>f+1)},v=f=>{n(f),a(_=>new Set(_).add(f)),i(!1)},N=f=>{p(f),i(!1)},w=()=>{p(void 0)},j=()=>{h(f=>f+1)};return e.jsxs("div",{className:"flex h-screen bg-transparent",children:[e.jsx(G,{activeTab:t,onTabChange:v,onConfigSaved:b,isOpen:o,onToggle:()=>i(!o),currentConversationId:u,onConversationSelect:N,onConversationDeleted:w,conversationRefreshTrigger:g}),e.jsxs("main",{className:"flex-1 overflow-hidden border-l border-white/20 bg-white/35 backdrop-blur-xl relative",children:[e.jsx("button",{onClick:()=>i(!o),className:"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white/80 backdrop-blur-sm rounded-lg shadow-lg text-slate-900","aria-label":"Toggle menu",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:`h-full ${t==="chat"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(W,{configVersion:r,currentConversationId:u,onConversationChange:p,onRefreshConversations:j})})}),s.has("notes")&&e.jsx("div",{className:`h-full ${t==="notes"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(Y,{})})}),s.has("upload")&&e.jsx("div",{className:`h-full ${t==="upload"?"":"hidden"}`,children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"flex h-full items-center justify-center text-slate-500",children:"åŠ è½½ä¸­..."}),children:e.jsx(X,{})})})]})]})}I.createRoot(document.getElementById("root")).render(e.jsx(U.StrictMode,{children:e.jsx(Z,{})}));export{le as a,J as b,re as c,oe as d,se as g,ne as s};
